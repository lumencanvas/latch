# 3D Category

> 3D geometry, materials, lighting, and rendering using Three.js in LATCH.

**Category Color:** Blue (`#0EA5E9`)
**Icon:** `box`

---

## Scene 3D

Container for 3D objects - the root of a 3D scene graph.

| Property | Value |
|----------|-------|
| **ID** | `scene-3d` |
| **Icon** | `box` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `objects` | `object3d` | Objects to add (multiple) |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `scene` | `scene3d` | The Three.js Scene |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `backgroundColor` | `color` | `#000000` | Scene background color |
| `showGrid` | `toggle` | `false` | Show grid helper |

### Implementation
Creates a `THREE.Scene` and adds all connected objects to it. Can include meshes, lights, groups, etc.

---

## Camera 3D

Perspective or orthographic camera for viewing scenes.

| Property | Value |
|----------|-------|
| **ID** | `camera-3d` |
| **Icon** | `camera` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `posX/Y/Z` | `number` | Position override |
| `targetX/Y/Z` | `number` | Look-at target override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `camera` | `camera3d` | The Three.js Camera |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `type` | `select` | `perspective` | options: perspective, orthographic | Camera type |
| `fov` | `number` | `50` | min: 10, max: 120 | Field of view (perspective) |
| `near` | `number` | `0.1` | - | Near clipping plane |
| `far` | `number` | `1000` | - | Far clipping plane |
| `orthoSize` | `number` | `5` | - | Ortho frustum size |
| `posX/Y/Z` | `number` | 0, 2, 5 | - | Camera position |
| `targetX/Y/Z` | `number` | 0, 0, 0 | - | Look-at target |

### Implementation
Creates `THREE.PerspectiveCamera` or `THREE.OrthographicCamera` based on type. Uses `lookAt()` to point at target.

---

## Render 3D

Render a 3D scene to texture output.

| Property | Value |
|----------|-------|
| **ID** | `render-3d` |
| **Icon** | `image` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `scene` | `scene3d` | Scene to render (required) |
| `camera` | `camera3d` | Camera to use (required) |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `texture` | `texture` | Rendered output |
| `depth` | `texture` | Depth buffer texture |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `width` | `number` | `512` | min: 64, max: 2048 | Output width |
| `height` | `number` | `512` | min: 64, max: 2048 | Output height |
| `includeDepth` | `toggle` | `false` | - | Output depth texture |

### Implementation
Uses `THREE.WebGLRenderer` with `WebGLRenderTarget` to render scene to texture. The output can be fed into 2D visual nodes.

---

## Box 3D

Create a box/cube mesh.

| Property | Value |
|----------|-------|
| **ID** | `box-3d` |
| **Icon** | `box` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `width/height/depth` | `number` | Dimension overrides |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `width` | `number` | `1` | Width |
| `height` | `number` | `1` | Height |
| `depth` | `number` | `1` | Depth |
| `color` | `color` | `#808080` | Default material color |

### Implementation
Creates `THREE.BoxGeometry` with `THREE.MeshStandardMaterial`. If material input is connected, uses that instead of default.

---

## Sphere 3D

Create a sphere mesh.

| Property | Value |
|----------|-------|
| **ID** | `sphere-3d` |
| **Icon** | `circle` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `radius` | `number` | Radius override |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `radius` | `number` | `0.5` | - | Sphere radius |
| `widthSegments` | `number` | `32` | min: 3, max: 64 | Horizontal segments |
| `heightSegments` | `number` | `16` | min: 2, max: 32 | Vertical segments |
| `color` | `color` | `#808080` | - | Default color |

### Implementation
Creates `THREE.SphereGeometry`. Higher segment counts = smoother sphere.

---

## Plane 3D

Create a flat plane mesh.

| Property | Value |
|----------|-------|
| **ID** | `plane-3d` |
| **Icon** | `square` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `width/height` | `number` | Dimension overrides |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `width` | `number` | `1` | Plane width |
| `height` | `number` | `1` | Plane height |
| `color` | `color` | `#808080` | Default color |

### Implementation
Creates `THREE.PlaneGeometry`. Default orientation is XY plane (facing +Z).

---

## Cylinder 3D

Create a cylinder mesh.

| Property | Value |
|----------|-------|
| **ID** | `cylinder-3d` |
| **Icon** | `cylinder` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `radiusTop/Bottom` | `number` | Radius overrides |
| `height` | `number` | Height override |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `radiusTop` | `number` | `0.5` | - | Top radius |
| `radiusBottom` | `number` | `0.5` | - | Bottom radius |
| `height` | `number` | `1` | - | Cylinder height |
| `radialSegments` | `number` | `32` | min: 3, max: 64 | Radial segments |
| `color` | `color` | `#808080` | - | Default color |

### Implementation
Creates `THREE.CylinderGeometry`. Set `radiusTop` to 0 for a cone.

---

## Torus 3D

Create a torus (donut) mesh.

| Property | Value |
|----------|-------|
| **ID** | `torus-3d` |
| **Icon** | `circle-dot` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `radius` | `number` | Main radius override |
| `tube` | `number` | Tube radius override |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `radius` | `number` | `0.5` | - | Main radius |
| `tube` | `number` | `0.2` | - | Tube radius |
| `radialSegments` | `number` | `16` | min: 2, max: 32 | Radial segments |
| `tubularSegments` | `number` | `100` | min: 3, max: 200 | Tubular segments |
| `color` | `color` | `#808080` | - | Default color |

### Implementation
Creates `THREE.TorusGeometry`.

---

## Transform 3D

Apply position, rotation, and scale to a 3D object.

| Property | Value |
|----------|-------|
| **ID** | `transform-3d` |
| **Icon** | `move-3d` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | Object to transform (required) |
| `posX/Y/Z` | `number` | Position override |
| `rotX/Y/Z` | `number` | Rotation override (degrees) |
| `scaleX/Y/Z` | `number` | Scale override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | Transformed object |
| `transform` | `transform3d` | Transform data |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `posX/Y/Z` | `number` | `0` | Position |
| `rotX/Y/Z` | `number` | `0` | Rotation (degrees) |
| `scaleX/Y/Z` | `number` | `1` | Scale |

### Implementation
Modifies the object's `position`, `rotation`, and `scale` properties. Rotation is converted from degrees to radians.

---

## Material 3D

Create a PBR (Physically Based Rendering) material.

| Property | Value |
|----------|-------|
| **ID** | `material-3d` |
| **Icon** | `palette` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `colorMap` | `texture` | Albedo/diffuse texture |
| `normalMap` | `texture` | Normal map |
| `roughnessMap` | `texture` | Roughness map |
| `metalnessMap` | `texture` | Metalness map |
| `metalness/roughness/opacity` | `number` | Value overrides |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `material` | `material3d` | The material |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `type` | `select` | `standard` | options: standard, basic, phong, physical | Material type |
| `color` | `color` | `#808080` | - | Base color |
| `metalness` | `slider` | `0` | min: 0, max: 1 | Metalness |
| `roughness` | `slider` | `0.5` | min: 0, max: 1 | Roughness |
| `opacity` | `slider` | `1` | min: 0, max: 1 | Opacity |
| `wireframe` | `toggle` | `false` | - | Wireframe mode |
| `side` | `select` | `front` | options: front, back, double | Render side |
| `emissive` | `color` | `#000000` | - | Emissive color |
| `emissiveIntensity` | `number` | `0` | min: 0, max: 10 | Emissive strength |

### Implementation
Creates `THREE.MeshStandardMaterial`, `THREE.MeshBasicMaterial`, `THREE.MeshPhongMaterial`, or `THREE.MeshPhysicalMaterial` based on type selection.

---

## Group 3D

Combine multiple objects into a group.

| Property | Value |
|----------|-------|
| **ID** | `group-3d` |
| **Icon** | `layers` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `objects` | `object3d` | Objects to group (multiple) |
| `posX/Y/Z` | `number` | Group position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The group object |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `posX/Y/Z` | `number` | `0` | Group position |

### Implementation
Creates `THREE.Group` and adds all connected objects as children. Transform applied to group affects all children.

---

## Ambient Light

Uniform lighting from all directions.

| Property | Value |
|----------|-------|
| **ID** | `ambient-light-3d` |
| **Icon** | `sun` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `intensity` | `number` | Intensity override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `light` | `light3d` | The light object |
| `object` | `object3d` | As generic object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `color` | `color` | `#ffffff` | - | Light color |
| `intensity` | `slider` | `0.5` | min: 0, max: 2 | Light intensity |

### Implementation
Creates `THREE.AmbientLight`. Illuminates all surfaces equally regardless of orientation.

---

## Directional Light

Sun-like light from a specific direction.

| Property | Value |
|----------|-------|
| **ID** | `directional-light-3d` |
| **Icon** | `sun-dim` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `intensity` | `number` | Intensity override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `light` | `light3d` | The light object |
| `object` | `object3d` | As generic object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `color` | `color` | `#ffffff` | - | Light color |
| `intensity` | `slider` | `1` | min: 0, max: 5 | Light intensity |
| `posX/Y/Z` | `number` | 5, 5, 5 | - | Light position (direction) |
| `castShadow` | `toggle` | `true` | - | Enable shadows |

### Implementation
Creates `THREE.DirectionalLight`. Light direction is from position toward scene origin.

---

## Point Light

Omnidirectional light radiating from a point.

| Property | Value |
|----------|-------|
| **ID** | `point-light-3d` |
| **Icon** | `lightbulb` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `intensity` | `number` | Intensity override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `light` | `light3d` | The light object |
| `object` | `object3d` | As generic object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `color` | `color` | `#ffffff` | - | Light color |
| `intensity` | `slider` | `1` | min: 0, max: 5 | Light intensity |
| `distance` | `number` | `0` | min: 0 | Falloff distance (0 = infinite) |
| `decay` | `number` | `2` | min: 0, max: 5 | Light decay rate |
| `posX/Y/Z` | `number` | 0, 2, 0 | - | Light position |
| `castShadow` | `toggle` | `false` | - | Enable shadows |

### Implementation
Creates `THREE.PointLight`. Emits light equally in all directions from position.

---

## Spot Light

Cone-shaped spotlight.

| Property | Value |
|----------|-------|
| **ID** | `spot-light-3d` |
| **Icon** | `flashlight` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `intensity` | `number` | Intensity override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `light` | `light3d` | The light object |
| `object` | `object3d` | As generic object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `color` | `color` | `#ffffff` | - | Light color |
| `intensity` | `slider` | `1` | min: 0, max: 5 | Light intensity |
| `distance` | `number` | `0` | min: 0 | Falloff distance |
| `angle` | `slider` | `30` | min: 1, max: 90 | Cone angle (degrees) |
| `penumbra` | `slider` | `0.1` | min: 0, max: 1 | Soft edge percentage |
| `decay` | `number` | `2` | min: 0, max: 5 | Light decay |
| `posX/Y/Z` | `number` | 0, 5, 0 | - | Light position |
| `targetX/Y/Z` | `number` | 0, 0, 0 | - | Target position |
| `castShadow` | `toggle` | `true` | - | Enable shadows |

### Implementation
Creates `THREE.SpotLight`. Points from position toward target.

---

## GLTF Loader

Load 3D models in GLTF/GLB format.

| Property | Value |
|----------|-------|
| **ID** | `gltf-loader` |
| **Icon** | `file-box` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `url` | `string` | Model URL override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | Loaded model |
| `loading` | `boolean` | Loading state |
| `error` | `string` | Error message |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `url` | `text` | `''` | - | Model URL |
| `posX/Y/Z` | `number` | `0` | - | Initial position |
| `scale` | `number` | `1` | min: 0.001, max: 100 | Model scale |

### Implementation
Uses Three.js `GLTFLoader` to load GLTF/GLB files. Supports embedded textures, animations, and materials.
