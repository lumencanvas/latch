import{d as B,r as S,m as W,w as z,n as N,q as $,a as q,o as D,v as ee,s as Z,b,t as R,_ as G,B as A,F as te,z as ne,y as ae}from"./index-BZiD0Tmn.js";const le={key:0,class:"knob-label"},se={key:1,class:"knob-value"},ie=B({__name:"RotaryKnob",props:{modelValue:{},min:{default:0},max:{default:1},step:{default:.01},label:{},accentColor:{default:"#ff6b35"},size:{default:"medium"},showValue:{type:Boolean,default:!0},valueFormat:{type:Function,default:g=>g.toFixed(2)}},emits:["update:modelValue"],setup(g,{emit:L}){const n=g,k=L,c=S(null),m=S(!1),w=S(0),x=S(0),T=W(()=>{switch(n.size){case"small":return{canvas:40,stroke:2,arcStroke:2.5,centerRadius:12};case"large":return{canvas:72,stroke:2.5,arcStroke:4,centerRadius:24};default:return{canvas:56,stroke:2,arcStroke:3,centerRadius:18}}}),M=W(()=>(n.modelValue-n.min)/(n.max-n.min)),C=Math.PI*.75,P=Math.PI*2.25,E=P-C,_=W(()=>C+M.value*E);function i(){if(!c.value)return;const t=c.value.getContext("2d");if(!t)return;const a=T.value.canvas,l=window.devicePixelRatio||1;c.value.width=a*l,c.value.height=a*l,c.value.style.width=a+"px",c.value.style.height=a+"px",t.scale(l,l);const s=a/2,d=a/2,r=a/2-4,{stroke:h,arcStroke:p,centerRadius:y}=T.value;t.clearRect(0,0,a,a),t.beginPath(),t.arc(s,d,r,C,P),t.strokeStyle="#333",t.lineWidth=h,t.lineCap="round",t.stroke(),M.value>.001&&(t.beginPath(),t.arc(s,d,r,C,_.value),t.strokeStyle=n.accentColor,t.lineWidth=p,t.lineCap="round",t.stroke()),t.beginPath(),t.arc(s,d,y,0,Math.PI*2),t.fillStyle="#1a1a1a",t.fill(),t.strokeStyle="#333",t.lineWidth=1,t.stroke();const V=y-4,Y=_.value,X=s+Math.cos(Y)*4,U=d+Math.sin(Y)*4,F=s+Math.cos(Y)*V,oe=d+Math.sin(Y)*V;t.beginPath(),t.moveTo(X,U),t.lineTo(F,oe),t.strokeStyle=n.accentColor,t.lineWidth=2,t.lineCap="round",t.stroke(),t.beginPath(),t.arc(s,d,2,0,Math.PI*2),t.fillStyle="#666",t.fill()}function f(t){m.value=!0,w.value=t.clientY,x.value=n.modelValue,window.addEventListener("mousemove",u),window.addEventListener("mouseup",v),t.preventDefault()}function u(t){if(!m.value)return;const a=w.value-t.clientY,l=(n.max-n.min)/150;let s=x.value+a*l;s=Math.round(s/n.step)*n.step,s=Math.max(n.min,Math.min(n.max,s)),k("update:modelValue",s)}function v(){m.value=!1,window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",v)}function e(t){t.preventDefault();const a=t.deltaY<0?1:-1,l=t.shiftKey?10:1;let s=n.modelValue+a*n.step*l;s=Math.round(s/n.step)*n.step,s=Math.max(n.min,Math.min(n.max,s)),k("update:modelValue",s)}function o(){const t=(n.min+n.max)/2;k("update:modelValue",t)}return z([()=>n.modelValue,()=>n.accentColor,()=>n.size],i),N(()=>{i()}),$(()=>{m.value&&(window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",v))}),(t,a)=>(D(),q("div",{class:ee(["rotary-knob",[g.size,{dragging:m.value}]])},[g.label?(D(),q("span",le,R(g.label),1)):Z("",!0),b("canvas",{ref_key:"canvas",ref:c,class:"knob-canvas",onMousedown:f,onWheel:e,onDblclick:o},null,544),g.showValue?(D(),q("span",se,R(g.valueFormat(g.modelValue)),1)):Z("",!0)],2))}}),we=G(ie,[["__scopeId","data-v-9468de6a"]]),ce={class:"envelope-editor"},ue={class:"envelope-values"},K=2,Q=2,H=5,re=B({__name:"EnvelopeEditor",props:{modelValue:{},width:{default:200},height:{default:100},accentColor:{default:"#ff6b35"}},emits:["update:modelValue"],setup(g,{emit:L}){const n=g,k=L,c=S(null),m=S(null),w=K+Q+H,x=W(()=>{const i=n.width,f=n.height,u=12,v=u+n.modelValue.attack/w*(i-u*2),e=v+n.modelValue.decay/w*(i-u*2),o=(i-u*2)*.2,t=e+o,a=i-u,l=u,s=f-u,d=l+(1-n.modelValue.sustain)*(s-l);return{start:{x:u,y:s},attack:{x:v,y:l},decay:{x:e,y:d},sustain:{x:t,y:d},release:{x:a,y:s},padding:u,top:l,bottom:s}});function T(){if(!c.value)return;const i=c.value.getContext("2d");if(!i)return;const f=n.width,u=n.height,v=window.devicePixelRatio||1;c.value.width=f*v,c.value.height=u*v,c.value.style.width=f+"px",c.value.style.height=u+"px",i.scale(v,v),i.clearRect(0,0,f,u),i.fillStyle="#0a0a0a",i.fillRect(0,0,f,u),i.strokeStyle="#1a1a1a",i.lineWidth=1;for(let t=0;t<=4;t++){const a=x.value.padding+t/4*(u-x.value.padding*2);i.beginPath(),i.moveTo(0,a),i.lineTo(f,a),i.stroke()}const e=x.value;i.beginPath(),i.moveTo(e.start.x,e.start.y),i.lineTo(e.attack.x,e.attack.y),i.lineTo(e.decay.x,e.decay.y),i.lineTo(e.sustain.x,e.sustain.y),i.lineTo(e.release.x,e.release.y),i.strokeStyle=n.accentColor,i.lineWidth=2,i.stroke(),i.lineTo(e.release.x,e.bottom),i.lineTo(e.start.x,e.bottom),i.closePath(),i.fillStyle=n.accentColor+"20",i.fill();const o=(t,a,l)=>{i.beginPath(),i.arc(t,a,l?7:5,0,Math.PI*2),i.fillStyle=l?n.accentColor:"#1a1a1a",i.fill(),i.strokeStyle=n.accentColor,i.lineWidth=2,i.stroke()};o(e.attack.x,e.attack.y,m.value==="attack"),o(e.decay.x,e.decay.y,m.value==="decay"),o(e.sustain.x,e.sustain.y,m.value==="sustain"),i.fillStyle="#666",i.font="9px monospace",i.textAlign="center",i.fillText("A",e.attack.x,u-2),i.fillText("D",e.decay.x,u-2),i.fillText("S",e.sustain.x,u-2),i.fillText("R",e.release.x,u-2)}function M(i,f){const u=x.value,v=12,e=(o,t)=>Math.sqrt((i-o)**2+(f-t)**2);return e(u.attack.x,u.attack.y)<v?"attack":e(u.decay.x,u.decay.y)<v?"decay":e(u.sustain.x,u.sustain.y)<v?"sustain":null}function C(i){if(!c.value)return;const f=c.value.getBoundingClientRect(),u=i.clientX-f.left,v=i.clientY-f.top,e=M(u,v);e&&(m.value=e,window.addEventListener("mousemove",P),window.addEventListener("mouseup",E),i.preventDefault())}function P(i){if(!m.value||!c.value)return;const f=c.value.getBoundingClientRect(),u=i.clientX-f.left,v=i.clientY-f.top,e=n.width,o=n.height,t=x.value.padding,a=Math.max(0,Math.min(1,(u-t)/(e-t*2))),l=Math.max(0,Math.min(1,(v-t)/(o-t*2))),s={...n.modelValue};switch(m.value){case"attack":s.attack=a*K;break;case"decay":{const d=n.modelValue.attack/w,r=Math.max(d,a)-d;s.decay=r*w,s.decay=Math.min(Q,Math.max(.001,s.decay)),s.sustain=1-l;break}case"sustain":s.sustain=1-l;break}s.attack=Math.max(.001,Math.min(K,s.attack)),s.decay=Math.max(.001,Math.min(Q,s.decay)),s.sustain=Math.max(0,Math.min(1,s.sustain)),s.release=Math.max(.001,Math.min(H,s.release)),k("update:modelValue",s)}function E(){m.value=null,window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",E)}function _(i){i.preventDefault();const f=i.deltaY<0?.1:-.1,u=Math.max(.001,Math.min(H,n.modelValue.release+f));k("update:modelValue",{...n.modelValue,release:u})}return z(()=>n.modelValue,T,{deep:!0}),N(()=>{T()}),$(()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",E)}),(i,f)=>(D(),q("div",ce,[b("canvas",{ref_key:"canvas",ref:c,class:"envelope-canvas",onMousedown:C,onWheel:_},null,544),b("div",ue,[b("span",null,"A: "+R(g.modelValue.attack.toFixed(2))+"s",1),b("span",null,"D: "+R(g.modelValue.decay.toFixed(2))+"s",1),b("span",null,"S: "+R((g.modelValue.sustain*100).toFixed(0))+"%",1),b("span",null,"R: "+R(g.modelValue.release.toFixed(2))+"s",1)])]))}}),xe=G(re,[["__scopeId","data-v-207d5d27"]]),de={class:"eq-editor"},he={class:"eq-values"},O=20,j=2e4,I=-24,J=24,me=B({__name:"EQEditor",props:{modelValue:{},width:{default:240},height:{default:120},accentColor:{default:"#a855f7"}},emits:["update:modelValue"],setup(g,{emit:L}){const n=g,k=L,c=S(null),m=S(null),w=["#ef4444","#22c55e","#3b82f6"];function x(e){const t=Math.log10(O),a=Math.log10(j);return 10+(Math.log10(e)-t)/(a-t)*(n.width-10*2)}function T(e){const t=Math.log10(O),a=Math.log10(j),l=(e-10)/(n.width-10*2);return Math.pow(10,t+l*(a-t))}function M(e){const t=(e-I)/(J-I);return n.height-10-t*(n.height-10*2)}function C(e){const t=(n.height-10-e)/(n.height-20);return I+t*(J-I)}function P(e){let o=0;for(const t of n.modelValue.bands){const a=Math.log2(e/t.frequency),l=1/t.q,s=t.gain*Math.exp(-(a*a)/(2*l*l));o+=s}return o}function E(){if(!c.value)return;const e=c.value.getContext("2d");if(!e)return;const o=n.width,t=n.height,a=window.devicePixelRatio||1;c.value.width=o*a,c.value.height=t*a,c.value.style.width=o+"px",c.value.style.height=t+"px",e.scale(a,a),e.clearRect(0,0,o,t),e.fillStyle="#0a0a0a",e.fillRect(0,0,o,t);const l=10;e.strokeStyle="#1a1a1a",e.lineWidth=1;for(let r=-24;r<=24;r+=12){const h=M(r);e.beginPath(),e.moveTo(l,h),e.lineTo(o-l,h),e.stroke()}e.strokeStyle="#333";const s=M(0);e.beginPath(),e.moveTo(l,s),e.lineTo(o-l,s),e.stroke(),e.strokeStyle="#1a1a1a";for(const r of[100,1e3,1e4]){const h=x(r);e.beginPath(),e.moveTo(h,l),e.lineTo(h,t-l),e.stroke()}e.beginPath();let d=!0;for(let r=l;r<=o-l;r+=2){const h=T(r),p=P(h),y=M(p);d?(e.moveTo(r,y),d=!1):e.lineTo(r,y)}e.strokeStyle=n.accentColor,e.lineWidth=2,e.stroke(),e.lineTo(o-l,s),e.lineTo(l,s),e.closePath(),e.fillStyle=n.accentColor+"15",e.fill();for(let r=0;r<n.modelValue.bands.length;r++){const h=n.modelValue.bands[r];e.beginPath();let p=!0;for(let y=l;y<=o-l;y+=2){const V=T(y),Y=Math.log2(V/h.frequency),X=1/h.q,U=h.gain*Math.exp(-(Y*Y)/(2*X*X)),F=M(U);p?(e.moveTo(y,F),p=!1):e.lineTo(y,F)}e.strokeStyle=w[r]+"60",e.lineWidth=1,e.stroke()}for(let r=0;r<n.modelValue.bands.length;r++){const h=n.modelValue.bands[r],p=x(h.frequency),y=M(h.gain),V=m.value===r;e.beginPath(),e.arc(p,y,V?8:6,0,Math.PI*2),e.fillStyle=V?w[r]:"#1a1a1a",e.fill(),e.strokeStyle=w[r],e.lineWidth=2,e.stroke(),e.fillStyle="#666",e.font="9px monospace",e.textAlign="center",e.fillText(`${r+1}`,p,y+3)}e.fillStyle="#444",e.font="8px monospace",e.textAlign="center",e.fillText("100",x(100),t-2),e.fillText("1k",x(1e3),t-2),e.fillText("10k",x(1e4),t-2)}function _(e,o){for(let a=0;a<n.modelValue.bands.length;a++){const l=n.modelValue.bands[a],s=x(l.frequency),d=M(l.gain);if(Math.sqrt((e-s)**2+(o-d)**2)<15)return a}return null}function i(e){if(!c.value)return;const o=c.value.getBoundingClientRect(),t=n.width/o.width,a=n.height/o.height,l=(e.clientX-o.left)*t,s=(e.clientY-o.top)*a,d=_(l,s);d!==null&&(m.value=d,c.value.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation())}function f(e){if(m.value===null||!c.value)return;const o=c.value.getBoundingClientRect(),t=n.width/o.width,a=n.height/o.height,l=(e.clientX-o.left)*t,s=(e.clientY-o.top)*a,d=[...n.modelValue.bands];d[m.value]={...d[m.value],frequency:Math.max(O,Math.min(j,T(l))),gain:Math.max(I,Math.min(J,C(s)))},k("update:modelValue",{bands:d}),e.preventDefault(),e.stopPropagation()}function u(e){m.value!==null&&c.value&&c.value.releasePointerCapture(e.pointerId),m.value=null}function v(e){if(!c.value)return;const o=c.value.getBoundingClientRect(),t=n.width/o.width,a=n.height/o.height,l=(e.clientX-o.left)*t,s=(e.clientY-o.top)*a,d=_(l,s);if(d!==null){e.preventDefault();const r=e.deltaY<0?.2:-.2,h=[...n.modelValue.bands];h[d]={...h[d],q:Math.max(.1,Math.min(10,h[d].q+r))},k("update:modelValue",{bands:h})}}return z(()=>n.modelValue,E,{deep:!0}),N(()=>{E()}),$(()=>{}),(e,o)=>(D(),q("div",de,[b("canvas",{ref_key:"canvas",ref:c,class:"eq-canvas",onPointerdown:A(i,["stop"]),onPointermove:A(f,["stop"]),onPointerup:A(u,["stop"]),onPointercancel:A(u,["stop"]),onWheel:A(v,["stop","prevent"]),onMousedown:o[0]||(o[0]=A(()=>{},["stop"])),onTouchstart:o[1]||(o[1]=A(()=>{},["stop"]))},null,544),b("div",he,[(D(!0),q(te,null,ne(g.modelValue.bands,(t,a)=>(D(),q("span",{key:a,style:ae({color:w[a]})},R(Math.round(t.frequency))+"Hz "+R(t.gain>0?"+":"")+R(t.gain.toFixed(1))+"dB ",5))),128))])]))}}),Me=G(me,[["__scopeId","data-v-0b6af4aa"]]),fe={class:"waveform-editor"},ve={class:"waveform-presets"},pe=["onClick"],ge=B({__name:"WaveformEditor",props:{modelValue:{},width:{default:200},height:{default:80},accentColor:{default:"#22c55e"},sampleCount:{default:64}},emits:["update:modelValue"],setup(g,{emit:L}){const n=g,k=L,c=S(null),m=S(!1),w=S(null),x={sine:(e,o)=>Math.sin(e/o*Math.PI*2),square:(e,o)=>e<o/2?1:-1,sawtooth:(e,o)=>2*(e/o)-1,triangle:(e,o)=>{const t=e/o;return t<.5?4*t-1:3-4*t}};function T(e){const o=x[e];return o?Array.from({length:n.sampleCount},(t,a)=>o(a,n.sampleCount)):n.modelValue.samples}const M=W(()=>{if(n.modelValue.samples.length===n.sampleCount)return n.modelValue.samples;const e=[];for(let o=0;o<n.sampleCount;o++){const t=o/n.sampleCount*n.modelValue.samples.length,a=Math.floor(t),l=Math.min(a+1,n.modelValue.samples.length-1),s=t-a;e.push(n.modelValue.samples[a]*(1-s)+n.modelValue.samples[l]*s)}return e});function C(){if(!c.value)return;const e=c.value.getContext("2d");if(!e)return;const o=n.width,t=n.height,a=window.devicePixelRatio||1;c.value.width=o*a,c.value.height=t*a,c.value.style.width=o+"px",c.value.style.height=t+"px",e.scale(a,a),e.clearRect(0,0,o,t),e.fillStyle="#0a0a0a",e.fillRect(0,0,o,t);const l=4,s=o-l*2,d=t-l*2,r=t/2;e.strokeStyle="#1a1a1a",e.lineWidth=1,e.beginPath(),e.moveTo(l,r),e.lineTo(o-l,r),e.stroke(),e.strokeStyle="#151515";for(const p of[.25,.75])e.beginPath(),e.moveTo(l,l+p*d),e.lineTo(o-l,l+p*d),e.stroke();e.beginPath();const h=M.value;for(let p=0;p<h.length;p++){const y=l+p/(h.length-1)*s,V=r-h[p]*(d/2);p===0?e.moveTo(y,V):e.lineTo(y,V)}if(e.strokeStyle=n.accentColor,e.lineWidth=2,e.stroke(),e.lineTo(o-l,r),e.lineTo(l,r),e.closePath(),e.fillStyle=n.accentColor+"20",e.fill(),m.value)for(let p=0;p<h.length;p++){const y=l+p/(h.length-1)*s,V=r-h[p]*(d/2);e.beginPath(),e.arc(y,V,2,0,Math.PI*2),e.fillStyle=n.accentColor,e.fill()}}function P(e){const t=n.width-8,a=(e-4)/t;return Math.max(0,Math.min(n.sampleCount-1,Math.round(a*(n.sampleCount-1))))}function E(e){const o=n.height/2,t=(n.height-8)/2;return Math.max(-1,Math.min(1,(o-e)/t))}function _(e,o){const t=P(e),a=E(o),l=[...M.value];if(w.value!==null){const s=P(w.value);if(s!==t){const d=t>s?1:-1;for(let r=s;r!==t;r+=d){const h=(r-s)/(t-s);l[r]=l[s]*(1-h)+a*h}}}l[t]=a,w.value=e,k("update:modelValue",{samples:l,preset:"custom"})}function i(e){if(!c.value)return;const o=c.value.getBoundingClientRect(),t=e.clientX-o.left,a=e.clientY-o.top;m.value=!0,w.value=null,_(t,a),window.addEventListener("mousemove",f),window.addEventListener("mouseup",u),e.preventDefault()}function f(e){if(!m.value||!c.value)return;const o=c.value.getBoundingClientRect(),t=e.clientX-o.left,a=e.clientY-o.top;_(t,a)}function u(){m.value=!1,w.value=null,window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",u)}function v(e){const o=T(e);k("update:modelValue",{samples:o,preset:e})}return z(()=>n.modelValue,C,{deep:!0}),N(()=>{C()}),$(()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",u)}),(e,o)=>(D(),q("div",fe,[b("canvas",{ref_key:"canvas",ref:c,class:"waveform-canvas",onMousedown:i},null,544),b("div",ve,[(D(),q(te,null,ne(["sine","square","sawtooth","triangle"],t=>b("button",{key:t,class:ee(["preset-btn",{active:g.modelValue.preset===t}]),onClick:a=>v(t)},R(t.charAt(0).toUpperCase()),11,pe)),64))])]))}}),ke=G(ge,[["__scopeId","data-v-80c3bfe2"]]);export{xe as E,we as R,ke as W,Me as a};
